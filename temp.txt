corregi todo lo q me diste y asi quedo todo: from core.entities.request_user import RequestUser
from core.repositories.request_user_repository import RequestUserRepository
from core.use_cases.request_user.create_request_user import CreateRequestUserUseCase
from core.use_cases.request_user.update_user_request import UpdateRequestUserUseCase 
from core.use_cases.request_user.get_request_user import GetRequestUserUseCase
from core.use_cases.request_user.delete_request_user import DeleteRequestUserUseCase 
from core.use_cases.request_user.list_users_request import ListRequestUsersUseCase 
from application.dtos.request_user_dtos import *
from typing import Optional, Union

class UserRequestService:
    def __init__(self, 
                 request_user_repository: RequestUserRepository, 
                 create_request_user: CreateRequestUserUseCase,
                 update_user_request: UpdateRequestUserUseCase,
                 get_user_request: GetRequestUserUseCase,
                 get_user_request_list: ListRequestUsersUseCase,
                 delete_user_request: DeleteRequestUserUseCase):
        self.request_user_repository = request_user_repository
        self.create_request_user = create_request_user
        self.update_user_request = update_user_request
        self.delete_user_request = delete_user_request
        self.get_user_request = get_user_request
        self.get_user_request_list = get_user_request_list

    def create_user(self, user_data: RequestUserCreateDTO) -> RequestUserResponseDTO:
        user = self.create_request_user.execute(
            ci=user_data.ci,
            username=user_data.username, 
            fullname=user_data.fullname,
            email=user_data.email,
            department_id=user_data.department_id
        )
        return RequestUserResponseDTO(
            id=user.id,
            username=user.username,
            fullname=user.fullname,
            email=user.email, 
            ci=user.ci,
            department_id=user.department_id
        )
    
    def get_user(self, user_data: Union[int, str]) -> Optional[RequestUser]:
        """Busca usuario por ID, username o email"""
        user = None
        
        if isinstance(user_data, int):
            user = self.request_user_repository.get_by_id(user_data)
        
        # Si es string, buscar por username o email
        if isinstance(user_data, str) and not user:
            user = self.request_user_repository.get_by_username(user_data)
        
        if isinstance(user_data, str) and not user:
            user = self.request_user_repository.get_by_email(user_data)
            
        return user
    
    def get_user_by_id(self, user_id: int)-> Optional[RequestUser]:
        return self.get_user_request.execute(user_id)
    
    def get_user_by_username(self, username: str) -> Optional[RequestUser]:
        return self.request_user_repository.get_by_username(username)
    
    def get_all_users(self) -> list[RequestUser]:
        return self.get_user_request_list.execute()
    
    def update_user(self, req_user_id: int, username: str, email: str, fullname: str, department_id: int) -> RequestUser:
        return self.update_user_request.execute(req_user_id, username, email, fullname, department_id )

    def delete_user(self, user_id: int) -> bool:
        return self.delete_user_request.execute(user_id) y from core.entities.department import Department
from core.repositories.department_repository import DepartmentRepository
from core.use_cases.department.create_department import CreateDepartmentUseCase
from core.use_cases.department.update_department import UpdateDepartmentUseCase 
from core.use_cases.department.get_department import GetDepartmentUseCase
from core.use_cases.department.delete_department import DeleteDepartmentUseCase 
from core.use_cases.department.list_department import ListDepartmentUseCase 
from application.dtos.department_dtos import *
from typing import Optional

class DepartmentService:
    def __init__(self, 
                 department_repository: DepartmentRepository, 
                 create_department: CreateDepartmentUseCase,
                 update_department: UpdateDepartmentUseCase,
                 get_department: GetDepartmentUseCase,
                 delete_department: DeleteDepartmentUseCase,
                 get_department_list: ListDepartmentUseCase):
        self.department_repository = department_repository
        self.create_department = create_department
        self.update_department = update_department
        self.delete_department = delete_department
        self.get_department = get_department
        self.get_department_list = get_department_list

    def create_department_f(self, name: str) -> DepartmentResponseDTO:
        department = self.create_department.execute(name)
        return DepartmentResponseDTO(id=department.id, name=department.name)
    
    def get_department_by_id(self, department_id: int) -> Optional[DepartmentResponseDTO]:
        department = self.get_department.execute(department_id)
        return DepartmentResponseDTO(id=department.id, name=department.name) if department else None
    
    def get_department_by_name(self, name: str) -> Optional[Department]:
        return self.department_repository.get_by_name(name)
    
    def get_all_departments(self) -> list[DepartmentResponseDTO]:
        departments = self.get_department_list.execute()
        return [DepartmentResponseDTO(id=dept.id, name=dept.name) for dept in departments]
    
    def update_department_f(self, department_id: int, name: str) -> Department:
        return self.update_department.execute(department_id, name)

    def delete_department_f(self, department_id: int) -> bool:
        return self.delete_department.execute(department_id)... ahora necesito que con esos servicios y los nuevos dtos me ayudes con los controllers from typing import Optional
from application.services.department_service import DepartmentService
from application.dtos.department_dtos import *

class DepartmentController:
    def __init__(self, department_service: DepartmentService):
        self.department_service = department_service
        
    def create_department(
        self, 
        name: str,
    ) -> DepartmentCreateDTO:
        request = DepartmentCreateDTO(
            name=name
        )
        return self.department_service.create_department_f(request)     # type: ignore
    
    def get_dpto(
        self,
        name: str,
    ) -> DepartmentResponseDTO:
        request = DepartmentCreateDTO(
            name=name
        )
        return self.department_service.get_department_by_name(request)   # type: ignore
    
    def update_department(
        self,
        id: int,
        name: Optional[str] = None,
    ) -> DepartmentResponseDTO:
        request = DepartmentResponseDTO(
            id=id,
            name=name
        )
        return self.department_service.update_department_f(request)
    
    def delete_department(
        self,
        department_id: int
    ) -> bool:
        request = department_id
        
        return self.department_service.delete_department_f(department_id)

    def list_department(self) -> list[DepartmentResponseDTO]:
        return self.department_service.get_all_departments() y from typing import Optional
from application.services.request_service import UserRequestService
from application.dtos.request_user_dtos import (
    CreateRequestUser, GetRequestUserUpdate,
    RequestUserList, CreateRequestUserResponse, 
    GetUserRequest, GetUserResponse,
    DeleteUserRequest, DeleteUserResponse
)

class RequestUserController:
    def __init__(self, request_user_service: UserRequestService):
        self.request_user_service = request_user_service
        
    def create_user(
        self, 
        username: str,
        fullname: str,
        email: str,
        ci: str,
        department_id: int
    ) -> CreateRequestUserResponse:
        request = CreateRequestUser(
            username=username,
            fullname=fullname, 
            email=email,
            ci=ci,
            department_id=department_id
        )
        return self.request_user_service.create_user(request)
    
    def get_user(
        self,
        user_id: Optional[int] = None,
        username: Optional[str] = None,
        email: Optional[str] = None
    ) -> GetUserResponse:
        request = GetUserRequest(
            user_id=user_id,
            username=username,
            email=email
        )
        return self.request_user_service.get_user(request)
    
    def update_user(
        self,
        id: int,
        username: Optional[str] = None,
        fullname: Optional[str] = None,
        email: Optional[str] = None,
        ci: Optional[str] = None,
        department_id: Optional[int] = None,
    ) -> GetRequestUserUpdate:
        request = CreateRequestUserResponse(
            id=id,
            username=username,  
            fullname=fullname,
            email=email,
            ci=ci,
            department_id=department_id
            
        )
        return self.request_user_service.update_user(request)
    
    def delete_user(self, user_id: int) -> DeleteUserResponse:
        request = DeleteUserRequest(user_id=user_id)
        
        return self.request_user_service.delete_user(request)

    def list_users(self) -> RequestUserList:
        return self.request_user_service.get_all_users()